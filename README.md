# wcm-io-devops.conga-aem-cms

This role deploys the configuration artifacts generated by the CONGA role [aem-cms](https://github.com/wcm-io-devops/conga-aem-definitions/blob/develop/conga-aem-definitions/src/main/roles/aem-cms.yaml) with Ansible. It is part of the wcm.io set of roles to integrate Ansible with [CONGA](http://devops.wcm.io/conga/) and cannot be used independently.

## Requirements

This role requires Ansible 2.0 or higher.

## Role Variables

The role requires the `aem_cms_user` and `aem_cms_group` variables to be set to the owner and group the files should have on the target system. Usually it uses the defaults defined by the [aem-cms](https://github.com/wcm-io-devops/ansible-aem-cms) role which it is designed to combined with.

## Dependencies

This role depends on
* [wcm-io-devops.conga-facts](https://github.com/wcm-io-devops/ansible-conga-facts)
  role for accessing the CONGA configuration model
* [wcm-io-devops.conga-files](https://github.com/wcm-io-devops/ansible-conga-files)
  role for deploying configuration files
* [wcm-io-devops.aem-service](https://github.com/wcm-io-devops/ansible-aem-service)
  role to initially start the instance and to provide the "aem restart"
  handler for
  [wcm-io-devops.conga-bundle-files](https://github.com/wcm-io-devops/ansible-conga-bundle-files)
  and [wcm-io-devops.conga-aem-packages](https://github.com/wcm-io-devops/ansible-conga-aem-packages).
* [wcm-io-devops.aem-security](https://github.com/wcm-io-devops/ansible-aem-security)
  role for applying security changes like changing the admin user
  password
* [wcm-io-devops.conga-bundle-files](https://github.com/wcm-io-devops/ansible-conga-bundle-files)
  role for deploying bundle related files
* [wcm-io-devops.conga-aem-packages](https://github.com/wcm-io-devops/ansible-conga-aem-packages)
  for deploying aem packages.

## Example

Compiles the CONGA configuration, installs AEM with the Ansible `wcm-io-devops.aem-cms` role and deploys the configuration from the CONGA `aem-cms` role.

	- hosts: localhost
	  roles:
	    - wcm-io-devops.conga-maven
	
	- hosts: aem
	  pre_tasks:
	    # Get CONGA facts for role aem-cms to set aem_cms_home below
	    - conga_facts:
	        conga_role_mapping: aem-cms
	  roles:
	    - { role: wcm-io-devops.aem-cms,
	        aem_cms_home: "{{ conga_config.quickstart.rootPath }}" }
	    - wcm-io-devops.conga-aem-cms

## License

Apache 2.0
