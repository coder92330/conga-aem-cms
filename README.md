# conga-aem-cms

This role deploys the configuration artifacts generated by the CONGA role [aem-cms](https://github.com/wcm-io-devops/conga-aem-definitions/blob/develop/conga-aem-definitions/src/main/roles/aem-cms.yaml) with Ansible. It is part of the wcm.io set of roles to integrate Ansible with [CONGA](http://devops.wcm.io/conga/) and cannot be used independently.

## Requirements

This role requires Ansible 2.0 or higher.

## Role Variables

The role requires the `aem_user` and `aem_group` variables to be set to the owner and group the files should have on the target system. Usually it uses the defaults defined by the [aem-cms](https://github.com/wcm-io-devops/ansible-aem-cms) role which it is designed to combined with.

## Dependencies

This role depends on the [conga-facts](https://github.com/wcm-io-devops/ansible-conga-facts) role for accessing the CONGA configuration model and on the [conga-files](https://github.com/wcm-io-devops/ansible-conga-files) and [conga-aem-packages](https://github.com/wcm-io-devops/ansible-conga-aem-packages) roles for deploying the configuration files and packages. It also depends on the restart handler from the [aem-service](https://github.com/wcm-io-devops/ansible-aem-service) role to restart the instance if the AEM start script has been changed.

## Example

Compiles the CONGA configuration, installs AEM with the Ansible `aem-cms` role and deploys the configuration from the CONGA `aem-cms` role.

	- hosts: localhost
	  roles:
	    - conga-maven
	
	- hosts: aem
	  pre_tasks:
	    # Get CONGA facts for role aem-cms to set aem_home below
	    - conga_facts:
	        conga_role_mapping: aem-cms
	  roles:
	    - { role: aem-cms,
	        aem_home: "{{ conga_config.quickstart.rootPath }}" }
	    - conga-aem-cms



## License

Apache 2.0
